[==========] Running 81 tests from 3 test cases.
[----------] Global test environment set-up.
[----------] 67 tests from TestLibRBD
seed 296094
[ RUN      ] TestLibRBD.CreateAndStat
using old format
image has size 2097152 and order 22
[       OK ] TestLibRBD.CreateAndStat (5705 ms)
[ RUN      ] TestLibRBD.CreateAndStatPP
using old format
[       OK ] TestLibRBD.CreateAndStatPP (192 ms)
[ RUN      ] TestLibRBD.GetId
using old format
[       OK ] TestLibRBD.GetId (16 ms)
[ RUN      ] TestLibRBD.GetIdPP
using old format
[       OK ] TestLibRBD.GetIdPP (19 ms)
[ RUN      ] TestLibRBD.GetBlockNamePrefix
using old format
[       OK ] TestLibRBD.GetBlockNamePrefix (16 ms)
[ RUN      ] TestLibRBD.GetBlockNamePrefixPP
using old format
[       OK ] TestLibRBD.GetBlockNamePrefixPP (17 ms)
[ RUN      ] TestLibRBD.OpenAio
using old format
image has size 2097152 and order 22
[       OK ] TestLibRBD.OpenAio (17 ms)
[ RUN      ] TestLibRBD.OpenAioFail
[       OK ] TestLibRBD.OpenAioFail (4 ms)
[ RUN      ] TestLibRBD.OpenAioPP
using old format
[       OK ] TestLibRBD.OpenAioPP (31 ms)
[ RUN      ] TestLibRBD.OpenAioFailPP
[       OK ] TestLibRBD.OpenAioFailPP (4 ms)
[ RUN      ] TestLibRBD.ResizeAndStat
using old format
[       OK ] TestLibRBD.ResizeAndStat (30 ms)
[ RUN      ] TestLibRBD.ResizeAndStatPP
using old format
[       OK ] TestLibRBD.ResizeAndStatPP (31 ms)
[ RUN      ] TestLibRBD.UpdateWatchAndResize
using old format
[       OK ] TestLibRBD.UpdateWatchAndResize (30 ms)
[ RUN      ] TestLibRBD.UpdateWatchAndResizePP
using old format
[       OK ] TestLibRBD.UpdateWatchAndResizePP (30 ms)
[ RUN      ] TestLibRBD.TestCreateLsDelete
using old format
image: image15
expected = image15
found image15
using old format
image: image15
image: image16
expected = image15
found image15
expected = image16
found image16
image: image16
expected = image16
found image16
[       OK ] TestLibRBD.TestCreateLsDelete (5721 ms)
[ RUN      ] TestLibRBD.TestCreateLsDeletePP
using old format
num images is: 1
expected: 1
image: image17
expected = image17
num images is: 2
expected: 2
image: image17
image: image18
expected = image17
expected = image18
num images is: 1
expected: 1
image: image18
expected = image18
[       OK ] TestLibRBD.TestCreateLsDeletePP (5467 ms)
[ RUN      ] TestLibRBD.TestCopy
using old format
image: image19
expected = image19
found image19
image: image19
image: image20
expected = image19
found image19
expected = image20
found image20
0.00% done
100.00% done
image: image19
image: image20
image: image21
expected = image19
found image19
expected = image20
found image20
expected = image21
found image21
[       OK ] TestLibRBD.TestCopy (5930 ms)
[ RUN      ] TestLibRBD.TestCopyPP
using old format
num images is: 1
expected: 1
image: image22
expected = image22
num images is: 2
expected: 2
image: image22
image: image23
expected = image22
expected = image23
0.00% done
100.00% done
num images is: 3
expected: 3
image: image22
image: image23
image: image24
expected = image22
expected = image23
expected = image24
[       OK ] TestLibRBD.TestCopyPP (1681869 ms)
[ RUN      ] TestLibRBD.TestCreateLsDeleteSnap
using old format
num snaps is: 1
expected: 1
snap: snap1
found snap1 with size 2097152
num snaps is: 2
expected: 2
snap: snap1
snap: snap2
found snap1 with size 2097152
found snap2 with size 4194304
num snaps is: 1
expected: 1
snap: snap2
found snap2 with size 4194304
num snaps is: 0
expected: 0
[       OK ] TestLibRBD.TestCreateLsDeleteSnap (4698 ms)
[ RUN      ] TestLibRBD.TestCreateLsDeleteSnapPP
using old format
num snaps is: 1
expected: 1
snap: snap1
found snap1 with size 2097152
num snaps is: 2
expected: 2
snap: snap1
snap: snap2
found snap1 with size 2097152
found snap2 with size 4194304
num snaps is: 1
expected: 1
snap: snap2
found snap2 with size 4194304
num snaps is: 0
expected: 0
[       OK ] TestLibRBD.TestCreateLsDeleteSnapPP (5948 ms)
[ RUN      ] TestLibRBD.TestCreateLsRenameSnapPP
using old format
num snaps is: 1
expected: 1
snap: snap1
found snap1 with size 2097152
num snaps is: 2
expected: 2
snap: snap1
snap: snap2
found snap1 with size 2097152
found snap2 with size 4194304
num snaps is: 2
expected: 2
snap: snap1-rename
snap: snap2
found snap1-rename with size 2097152
found snap2 with size 4194304
num snaps is: 1
expected: 1
snap: snap2-rename
found snap2-rename with size 4194304
num snaps is: 0
expected: 0
[       OK ] TestLibRBD.TestCreateLsRenameSnapPP (5431 ms)
[ RUN      ] TestLibRBD.TestIO
using old format
wrote: 512
wrote: 512
wrote: 512
wrote: 512
wrote: 512
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
read: 512
read: 512
read: 512
read: 512
read: 512
created completion
started read
read completion cb called!
return value is: 512
created completion
started read
read completion cb called!
return value is: 512
created completion
started read
read completion cb called!
return value is: 512
created completion
started read
read completion cb called!
return value is: 512
created completion
started read
read completion cb called!
return value is: 512
discard: 512~512 = 512
write completion cb called!
aio discard: 1536~512 = 0
read: 512
read: 512
read: 512
read: 512
read: 512
read completion cb called!
read completion cb called!
[       OK ] TestLibRBD.TestIO (48320 ms)
[ RUN      ] TestLibRBD.TestIOWithIOHint
using old format
wrote: 512
wrote: 512
wrote: 512
wrote: 512
wrote: 512
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
read: 512
read: 512
read: 512
read: 512
read: 512
created completion
started read
read completion cb called!
return value is: 512
created completion
started read
read completion cb called!
return value is: 512
created completion
started read
read completion cb called!
return value is: 512
created completion
started read
read completion cb called!
return value is: 512
created completion
started read
read completion cb called!
return value is: 512
discard: 512~512 = 512
write completion cb called!
aio discard: 1536~512 = 0
read: 512
read: 512
read: 512
read: 512
read: 512
read completion cb called!
[       OK ] TestLibRBD.TestIOWithIOHint (48293 ms)
[ RUN      ] TestLibRBD.TestEmptyDiscard
using old format
write completion cb called!
aio discard: 0~1048576 = 0
write completion cb called!
aio discard: 0~4194304 = 0
[       OK ] TestLibRBD.TestEmptyDiscard (19 ms)
[ RUN      ] TestLibRBD.TestIOPP
using old format
wrote: 512
wrote: 512
wrote: 512
wrote: 512
wrote: 512
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
read: 512
read: 512
read: 512
read: 512
read: 512
created completion
started read
read completion cb called!
return value is: 512
finished read
created completion
started read
read completion cb called!
return value is: 512
finished read
created completion
started read
read completion cb called!
return value is: 512
finished read
created completion
started read
read completion cb called!
return value is: 512
finished read
created completion
started read
read completion cb called!
return value is: 512
finished read
discard: 512~512
write completion cb called!
read: 512
read: 512
read: 512
read: 512
read: 512
[       OK ] TestLibRBD.TestIOPP (46731 ms)
[ RUN      ] TestLibRBD.TestIOPPWithIOHint
using old format
wrote: 512
wrote: 512
wrote: 512
wrote: 512
wrote: 512
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
read: 512
created completion
started read
read completion cb called!
return value is: 512
finished read
created completion
started read
read completion cb called!
return value is: 512
finished read
created completion
started read
read completion cb called!
return value is: 512
finished read
created completion
started read
read completion cb called!
return value is: 512
finished read
created completion
started read
read completion cb called!
return value is: 512
finished read
[       OK ] TestLibRBD.TestIOPPWithIOHint (14935 ms)
[ RUN      ] TestLibRBD.TestIOToSnapshot
using old format
num snaps is: 0
expected: 0
num snaps is: 1
expected: 1
snap: orig
found orig with size 2097152
read: 80
write test data!
wrote: 80
num snaps is: 2
expected: 2
snap: orig
snap: written
found orig with size 2097152
found written with size 2097152
read: 80
read: 80
read: 80
write to snapshot returned -30
(30) Read-only file system
read: 80
read: 80
wrote: 80
opening testimg@orig
read: 80
write to snapshot returned -30
(30) Read-only file system
num snaps is: 2
expected: 2
snap: orig
snap: written
found orig with size 2097152
found written with size 2097152
num snaps is: 1
expected: 1
snap: orig
found orig with size 2097152
num snaps is: 0
expected: 0
[       OK ] TestLibRBD.TestIOToSnapshot (6557 ms)
[ RUN      ] TestLibRBD.TestClone
made parent image "parent"
parent has no parent info
made snapshot "parent@parent_snap"
can't unprotect an unprotected snap
can't protect a protected snap
made and opened clone "child"
read: 8
read: 8
read: 8
sizes and overlaps are good between parent and child
sized down clone, changed overlap
parent info: size 4194304 obj_size 4194304 parent_pool -1
sized up clone, changed size but not overlap or parent's size
can't remove parent while child still exists
can't remove parent while still protected
removed parent snap after unprotecting
[       OK ] TestLibRBD.TestClone (3281 ms)
[ RUN      ] TestLibRBD.TestClone2
made parent image "parent"
parent has no parent info
made snapshot "parent@parent_snap"
can't unprotect an unprotected snap
can't protect a protected snap
made and opened clone "child"
[       OK ] TestLibRBD.TestClone2 (1760 ms)
[ RUN      ] TestLibRBD.TestCoR
SKIPPING due to disabled rbd_copy_on_read
[       OK ] TestLibRBD.TestCoR (0 ms)
[ RUN      ] TestLibRBD.ListChildren

trying to find test-librbd-node3-296094-7/image39
checking test-librbd-node3-296094-7/image39
found child test-librbd-node3-296094-7/image39


trying to find test-librbd-node3-296094-7/image39
checking test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-7/image39
found child test-librbd-node3-296094-7/image39


trying to find test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-6/image40
found child test-librbd-node3-296094-6/image40


trying to find test-librbd-node3-296094-7/image39
checking test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-7/image39
found child test-librbd-node3-296094-7/image39


trying to find test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-6/image40
found child test-librbd-node3-296094-6/image40


trying to find test-librbd-node3-296094-7/image41
checking test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-7/image39
checking test-librbd-node3-296094-7/image41
found child test-librbd-node3-296094-7/image41


trying to find test-librbd-node3-296094-7/image39
checking test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-7/image39
found child test-librbd-node3-296094-7/image39


trying to find test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-6/image40
found child test-librbd-node3-296094-6/image40


trying to find test-librbd-node3-296094-7/image41
checking test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-7/image39
checking test-librbd-node3-296094-7/image41
found child test-librbd-node3-296094-7/image41


trying to find test-librbd-node3-296094-7/image42
checking test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-7/image39
checking test-librbd-node3-296094-7/image41
checking test-librbd-node3-296094-7/image42
found child test-librbd-node3-296094-7/image42


trying to find test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-6/image40
found child test-librbd-node3-296094-6/image40


trying to find test-librbd-node3-296094-7/image41
checking test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-7/image41
found child test-librbd-node3-296094-7/image41


trying to find test-librbd-node3-296094-7/image42
checking test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-7/image41
checking test-librbd-node3-296094-7/image42
found child test-librbd-node3-296094-7/image42


trying to find test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-6/image40
found child test-librbd-node3-296094-6/image40


trying to find test-librbd-node3-296094-7/image42
checking test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-7/image42
found child test-librbd-node3-296094-7/image42


trying to find test-librbd-node3-296094-6/image40
checking test-librbd-node3-296094-6/image40
found child test-librbd-node3-296094-6/image40

[       OK ] TestLibRBD.ListChildren (11698 ms)
[ RUN      ] TestLibRBD.ListChildrenTiered

trying to find test-librbd-node3-296094-8/image44
checking test-librbd-node3-296094-8/image44
found child test-librbd-node3-296094-8/image44


trying to find test-librbd-node3-296094-8/image44
checking test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-8/image44
found child test-librbd-node3-296094-8/image44


trying to find test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-1/image45
found child test-librbd-node3-296094-1/image45


trying to find test-librbd-node3-296094-8/image44
checking test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-8/image44
found child test-librbd-node3-296094-8/image44


trying to find test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-1/image45
found child test-librbd-node3-296094-1/image45


trying to find test-librbd-node3-296094-8/image46
checking test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-8/image44
checking test-librbd-node3-296094-8/image46
found child test-librbd-node3-296094-8/image46


trying to find test-librbd-node3-296094-8/image44
checking test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-8/image44
found child test-librbd-node3-296094-8/image44


trying to find test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-1/image45
found child test-librbd-node3-296094-1/image45


trying to find test-librbd-node3-296094-8/image46
checking test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-8/image44
checking test-librbd-node3-296094-8/image46
found child test-librbd-node3-296094-8/image46


trying to find test-librbd-node3-296094-8/image47
checking test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-8/image44
checking test-librbd-node3-296094-8/image46
checking test-librbd-node3-296094-8/image47
found child test-librbd-node3-296094-8/image47


trying to find test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-1/image45
found child test-librbd-node3-296094-1/image45


trying to find test-librbd-node3-296094-8/image46
checking test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-8/image46
found child test-librbd-node3-296094-8/image46


trying to find test-librbd-node3-296094-8/image47
checking test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-8/image46
checking test-librbd-node3-296094-8/image47
found child test-librbd-node3-296094-8/image47


trying to find test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-1/image45
found child test-librbd-node3-296094-1/image45


trying to find test-librbd-node3-296094-8/image47
checking test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-8/image47
found child test-librbd-node3-296094-8/image47


trying to find test-librbd-node3-296094-1/image45
checking test-librbd-node3-296094-1/image45
found child test-librbd-node3-296094-1/image45

[       OK ] TestLibRBD.ListChildrenTiered (16051 ms)
[ RUN      ] TestLibRBD.LockingPP
using old format
[       OK ] TestLibRBD.LockingPP (64 ms)
[ RUN      ] TestLibRBD.FlushAio
using old format
[       OK ] TestLibRBD.FlushAio (284 ms)
[ RUN      ] TestLibRBD.FlushAioPP
using old format
[       OK ] TestLibRBD.FlushAioPP (270 ms)
[ RUN      ] TestLibRBD.ZeroLengthWrite
using old format
[       OK ] TestLibRBD.ZeroLengthWrite (17 ms)
[ RUN      ] TestLibRBD.ZeroLengthDiscard
using old format
[       OK ] TestLibRBD.ZeroLengthDiscard (19 ms)
[ RUN      ] TestLibRBD.ZeroLengthRead
using old format
[       OK ] TestLibRBD.ZeroLengthRead (16 ms)
[ RUN      ] TestLibRBD.LargeCacheRead
SKIPPING due to disabled cache
[       OK ] TestLibRBD.LargeCacheRead (0 ms)
[ RUN      ] TestLibRBD.TestPendingAio
[       OK ] TestLibRBD.TestPendingAio (308 ms)
[ RUN      ] TestLibRBD.Flatten
SKIPPING
[       OK ] TestLibRBD.Flatten (0 ms)
[ RUN      ] TestLibRBD.RebuildObjectMapViaLockOwner
SKIPPING
[       OK ] TestLibRBD.RebuildObjectMapViaLockOwner (0 ms)
[ RUN      ] TestLibRBD.RenameViaLockOwner
SKIPPING
[       OK ] TestLibRBD.RenameViaLockOwner (0 ms)
[ RUN      ] TestLibRBD.SnapCreateViaLockOwner
SKIPPING
[       OK ] TestLibRBD.SnapCreateViaLockOwner (0 ms)
[ RUN      ] TestLibRBD.SnapRemoveViaLockOwner
SKIPPING
[       OK ] TestLibRBD.SnapRemoveViaLockOwner (0 ms)
[ RUN      ] TestLibRBD.SnapRenameViaLockOwner
SKIPPING
[       OK ] TestLibRBD.SnapRenameViaLockOwner (0 ms)
[ RUN      ] TestLibRBD.SnapProtectViaLockOwner
SKIPPING
[       OK ] TestLibRBD.SnapProtectViaLockOwner (0 ms)
[ RUN      ] TestLibRBD.SnapUnprotectViaLockOwner
SKIPPING
[       OK ] TestLibRBD.SnapUnprotectViaLockOwner (0 ms)
[ RUN      ] TestLibRBD.FlattenViaLockOwner
SKIPPING
[       OK ] TestLibRBD.FlattenViaLockOwner (0 ms)
[ RUN      ] TestLibRBD.ResizeViaLockOwner
SKIPPING
[       OK ] TestLibRBD.ResizeViaLockOwner (0 ms)
[ RUN      ] TestLibRBD.ObjectMapConsistentSnap
SKIPPING
[       OK ] TestLibRBD.ObjectMapConsistentSnap (0 ms)
[ RUN      ] TestLibRBD.Metadata
SKIPPING
[       OK ] TestLibRBD.Metadata (0 ms)
[ RUN      ] TestLibRBD.UpdateFeatures
SKIPPING
[       OK ] TestLibRBD.UpdateFeatures (0 ms)
[ RUN      ] TestLibRBD.RebuildObjectMap
using old format
[       OK ] TestLibRBD.RebuildObjectMap (17 ms)
[ RUN      ] TestLibRBD.RebuildNewObjectMap
SKIPPING
[       OK ] TestLibRBD.RebuildNewObjectMap (0 ms)
[ RUN      ] TestLibRBD.BlockingAIO
using old format
[       OK ] TestLibRBD.BlockingAIO (21 ms)
[ RUN      ] TestLibRBD.ExclusiveLockTransition
SKIPPING
[       OK ] TestLibRBD.ExclusiveLockTransition (0 ms)
[ RUN      ] TestLibRBD.ExclusiveLockReadTransition
SKIPPING
[       OK ] TestLibRBD.ExclusiveLockReadTransition (0 ms)
[ RUN      ] TestLibRBD.CacheMayCopyOnWrite
SKIPPING
[       OK ] TestLibRBD.CacheMayCopyOnWrite (0 ms)
[ RUN      ] TestLibRBD.FlushEmptyOpsOnExternalSnapshot
using old format
[       OK ] TestLibRBD.FlushEmptyOpsOnExternalSnapshot (1311 ms)
[ RUN      ] TestLibRBD.TestImageOptions
0.00% done
100.00% done
[       OK ] TestLibRBD.TestImageOptions (1880 ms)
[ RUN      ] TestLibRBD.TestImageOptionsPP
0.00% done
100.00% done
[       OK ] TestLibRBD.TestImageOptionsPP (1455 ms)
[ RUN      ] TestLibRBD.ImagePollIO
using old format
wrote: 512
wrote: 512
wrote: 512
wrote: 512
wrote: 512
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started write
write completion cb called!
return value is: 0
finished write
created completion
started read
read completion cb called!
return value is: 512
created completion
started read
read completion cb called!
return value is: 512
created completion
started read
read completion cb called!
return value is: 512
created completion
started read
read completion cb called!
return value is: 512
created completion
started read
read completion cb called!
return value is: 512
[       OK ] TestLibRBD.ImagePollIO (39 ms)
[ RUN      ] TestLibRBD.Mirror
[       OK ] TestLibRBD.Mirror (70 ms)
[ RUN      ] TestLibRBD.FlushCacheWithCopyupOnExternalSnapshot
SKIPPING
[       OK ] TestLibRBD.FlushCacheWithCopyupOnExternalSnapshot (0 ms)
[ RUN      ] TestLibRBD.DiscardAfterWrite
using old format
[       OK ] TestLibRBD.DiscardAfterWrite (21 ms)
[ RUN      ] TestLibRBD.ExclusiveLock
SKIPPING
[       OK ] TestLibRBD.ExclusiveLock (0 ms)
[----------] 67 tests from TestLibRBD (1924650 ms total)

[----------] 7 tests from DiffIterateTest/0, where TypeParam = DiffIterateParams<false>
[ RUN      ] DiffIterateTest/0.DiffIterate
using old format
 wrote [430884~60198,3808708~73907,6628658~1386,7897958~34258,12846541~46565,17314068~69155,18285648~74409,20766199~85497]
 wrote [731331~1445,6016022~93254,11457317~93078,13884727~17784,13950079~91618,14272267~59661,15286512~9839,17542335~69912]
 diff was [731331~1445,6016022~93254,6576877~15920,8388608~3161787,12893106~2403245,17542335~69912]
[       OK ] DiffIterateTest/0.DiffIterate (38738902 ms)
[ RUN      ] DiffIterateTest/0.DiffIterateDiscard
using old format
iterate_cb 0~256
iterate_cb 0~256
iterate_cb 0~256
iterate_cb 0~256
[       OK ] DiffIterateTest/0.DiffIterateDiscard (690905 ms)
[ RUN      ] DiffIterateTest/0.DiffIterateStress
using old format
